from flask import Flask, render_template, request, redirect, url_for, session, jsonify
import sqlite3
from datetime import datetime
import os
import re

app = Flask(__name__)
app.secret_key = 'python_master_2024'


def init_db():
    conn = sqlite3.connect('python_game.db', check_same_thread=False)
    c = conn.cursor()

    # –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    c.execute('''CREATE TABLE IF NOT EXISTS users (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        username TEXT UNIQUE NOT NULL,
        password TEXT NOT NULL,
        experience INTEGER DEFAULT 0,
        level INTEGER DEFAULT 1,
        daily_streak INTEGER DEFAULT 0,
        last_login DATE,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    )''')

    # –¢–∞–±–ª–∏—Ü–∞ —É—Ä–æ–∫–æ–≤
    c.execute('''CREATE TABLE IF NOT EXISTS lessons (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        title TEXT NOT NULL,
        description TEXT,
        content TEXT,
        detailed_explanation TEXT,
        code_example TEXT,
        exercise TEXT,
        exercise_explanation TEXT,
        solution TEXT,
        hints TEXT,
        difficulty INTEGER DEFAULT 1,
        order_num INTEGER,
        xp_reward INTEGER DEFAULT 10
    )''')

    # –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    c.execute('''CREATE TABLE IF NOT EXISTS progress (
        user_id INTEGER,
        lesson_id INTEGER,
        completed BOOLEAN DEFAULT 0,
        score INTEGER DEFAULT 0,
        PRIMARY KEY (user_id, lesson_id)
    )''')

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–∫–æ–≤
    c.execute("SELECT COUNT(*) FROM lessons")
    count = c.fetchone()[0]

    if count == 0:
        lessons = [
            # –£—Ä–æ–∫–∏ 1-5 (–Ω–∞—á–∞–ª—å–Ω—ã–µ)
            (1, "–ü–µ—Ä–≤–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞", "–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å Python",
             "Python - —ç—Ç–æ —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–≥–∫–æ —á–∏—Ç–∞—Ç—å –∏ –ø–∏—Å–∞—Ç—å. –í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã –Ω–∞—É—á–∏–º—Å—è –≤—ã–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ —ç–∫—Ä–∞–Ω.",
             "–§—É–Ω–∫—Ü–∏—è print() –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞ —ç–∫—Ä–∞–Ω. –û–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç –≤ –∫–∞–≤—ã—á–∫–∞—Ö (–æ–¥–∏–Ω–∞—Ä–Ω—ã—Ö –∏–ª–∏ –¥–≤–æ–π–Ω—ã—Ö) –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –µ–≥–æ –≤ –∫–æ–Ω—Å–æ–ª–∏.",
             "print('Hello, World!')",
             "–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≤–æ–¥–∏—Ç –Ω–∞ —ç–∫—Ä–∞–Ω —Ñ—Ä–∞–∑—É: '–ü—Ä–∏–≤–µ—Ç, Python!'",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é print() –∏ –ø–µ—Ä–µ–¥–∞–π—Ç–µ –µ–π —Å—Ç—Ä–æ–∫—É '–ü—Ä–∏–≤–µ—Ç, Python!' –≤ –∫–∞–≤—ã—á–∫–∞—Ö.",
             "print('–ü—Ä–∏–≤–µ—Ç, Python!')",
             '‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é print()\n‚Ä¢ –¢–µ–∫—Å—Ç –∑–∞–∫–ª—é—á–∏—Ç–µ –≤ –∫–∞–≤—ã—á–∫–∏\n‚Ä¢ –ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–∫–æ–±–∫–∏',
             1, 10),

            (2, "–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ", "–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏",
             "–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ - —ç—Ç–æ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.",
             "–í Python –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ–º –∑–Ω–∞—á–µ–Ω–∏—è.",
             "name = '–ê–Ω–Ω–∞'\nage = 25\nprint('–ò–º—è:', name)\nprint('–í–æ–∑—Ä–∞—Å—Ç:', age)",
             "–°–æ–∑–¥–∞–π—Ç–µ –¥–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: –æ–¥–Ω—É –¥–ª—è –≤–∞—à–µ–≥–æ –∏–º–µ–Ω–∏, –¥—Ä—É–≥—É—é –¥–ª—è –≤–∞—à–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞.",
             "–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é name –∏ –ø—Ä–∏—Å–≤–æ–π—Ç–µ –µ–π –≤–∞—à–µ –∏–º—è. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é age –∏ –ø—Ä–∏—Å–≤–æ–π—Ç–µ –µ–π –≤–∞—à –≤–æ–∑—Ä–∞—Å—Ç.",
             "name = '–ò–≤–∞–Ω'\nage = 20\nprint('–ò–º—è:', name)\nprint('–í–æ–∑—Ä–∞—Å—Ç:', age)",
             '‚Ä¢ –î–ª—è —Å—Ç—Ä–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞–≤—ã—á–∫–∏\n‚Ä¢ –î–ª—è —á–∏—Å–µ–ª –∫–∞–≤—ã—á–∫–∏ –Ω–µ –Ω—É–∂–Ω—ã\n‚Ä¢ = –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è',
             1, 10),

            (3, "–í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö", "–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º",
             "–§—É–Ω–∫—Ü–∏—è input() –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.",
             "input() –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É –∏ –∂–¥–µ—Ç –≤–≤–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.",
             "name = input('–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç? ')\nprint('–ü—Ä–∏–≤–µ—Ç,', name)",
             "–°–ø—Ä–æ—Å–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–æ–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–π—Ç–µ –µ–≥–æ.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ input() –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–º–µ–Ω–∏, –∑–∞—Ç–µ–º print() –¥–ª—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è.",
             "name = input('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è: ')\nprint('–ü—Ä–∏–≤–µ—Ç,', name)",
             '‚Ä¢ input() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É\n‚Ä¢ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ print()',
             1, 10),

            (4, "–ß–∏—Å–ª–∞ –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏", "–†–∞–±–æ—Ç–∞ —Å —á–∏—Å–ª–∞–º–∏",
             "Python –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ +, -, *, / –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.",
             "a = 10\nb = 5\nprint('–°—É–º–º–∞:', a + b)\nprint('–†–∞–∑–Ω–æ—Å—Ç—å:', a - b)",
             "–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –¥–≤–∞ —á–∏—Å–ª–∞.",
             "–°–æ–∑–¥–∞–π—Ç–µ –¥–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å —á–∏—Å–ª–∞–º–∏ –∏ —Å–ª–æ–∂–∏—Ç–µ –∏—Ö.",
             "num1 = 15\nnum2 = 7\nresult = num1 + num2\nprint('–†–µ–∑—É–ª—å—Ç–∞—Ç:', result)",
             '‚Ä¢ + –¥–ª—è —Å–ª–æ–∂–µ–Ω–∏—è\n‚Ä¢ = –¥–ª—è –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è',
             1, 10),

            (5, "–°—Ç—Ä–æ–∫–∏", "–†–∞–±–æ—Ç–∞ —Å —Ç–µ–∫—Å—Ç–æ–º",
             "–°—Ç—Ä–æ–∫–∏ –≤ Python –º–æ–∂–Ω–æ —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å –∏ —É–º–Ω–æ–∂–∞—Ç—å.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ + –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫, * –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è.",
             "text1 = '–ü—Ä–∏–≤–µ—Ç'\ntext2 = '–º–∏—Ä'\nprint(text1 + ' ' + text2)",
             "–°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä–æ–∫—É 'Python' –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –µ–µ 3 —Ä–∞–∑–∞.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä * —Å–æ —Å—Ç—Ä–æ–∫–æ–π –∏ —á–∏—Å–ª–æ–º.",
             "word = 'Python'\nresult = word * 3\nprint(result)",
             '‚Ä¢ * –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Å—Ç—Ä–æ–∫—É\n‚Ä¢ –ö–∞–≤—ã—á–∫–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã',
             1, 10),

            # –£—Ä–æ–∫–∏ 6-10 (–±–∞–∑–æ–≤—ã–µ)
            (6, "–£—Å–ª–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã if", "–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π",
             "–û–ø–µ—Ä–∞—Ç–æ—Ä if –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–¥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Å–ª–æ–≤–∏—è.",
             "if –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏–µ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–¥, –µ—Å–ª–∏ –æ–Ω–æ –∏—Å—Ç–∏–Ω–Ω–æ.",
             "age = 18\nif age >= 18:\n    print('–í–∑—Ä–æ—Å–ª—ã–π')\nelse:\n    print('–†–µ–±–µ–Ω–æ–∫')",
             "–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –ª–∏ —á–∏—Å–ª–æ.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ if –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–∏—Å–ª–∞.",
             "num = 10\nif num > 0:\n    print('–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ')\nelse:\n    print('–ù–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ')",
             '‚Ä¢ if –∏–¥–µ—Ç –ø–µ—Ä–≤—ã–º\n‚Ä¢ else - –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –ª–æ–∂–Ω–æ\n‚Ä¢ –ù–µ –∑–∞–±—É–¥—å—Ç–µ –¥–≤–æ–µ—Ç–æ—á–∏–µ',
             2, 15),

            (7, "–¶–∏–∫–ª for", "–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π",
             "–¶–∏–∫–ª for –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∫–æ–¥ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ for –¥–ª—è –ø–µ—Ä–µ–±–æ—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–ø–∏—Å–∫–∞ –∏–ª–∏ —Å—Ç—Ä–æ–∫–∏.",
             "for i in range(5):\n    print(i)",
             "–ù–∞–ø–µ—á–∞—Ç–∞–π—Ç–µ —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 5 —Å –ø–æ–º–æ—â—å—é —Ü–∏–∫–ª–∞ for.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ range(1, 6).",
             "for i in range(1, 6):\n    print(i)",
             '‚Ä¢ range(1, 6) –¥–∞–µ—Ç —á–∏—Å–ª–∞ 1,2,3,4,5\n‚Ä¢ –ù–µ –∑–∞–±—É–¥—å—Ç–µ –¥–≤–æ–µ—Ç–æ—á–∏–µ',
             2, 15),

            (8, "–°–ø–∏—Å–∫–∏", "–ö–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö",
             "–°–ø–∏—Å–æ–∫ - —ç—Ç–æ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤.",
             "–≠–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –ª—é–±–æ–≥–æ —Ç–∏–ø–∞.",
             "fruits = ['—è–±–ª–æ–∫–æ', '–±–∞–Ω–∞–Ω', '–∞–ø–µ–ª—å—Å–∏–Ω']\nprint(fruits[0])",
             "–°–æ–∑–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –∏–∑ —Ç—Ä–µ—Ö –ª—é–±–∏–º—ã—Ö —Ñ–∏–ª—å–º–æ–≤ –∏ –≤—ã–≤–µ–¥–∏—Ç–µ –≤—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç.",
             "–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0.",
             "movies = ['–ò–Ω—Ç–µ—Ä—Å—Ç–µ–ª–ª–∞—Ä', '–ù–∞—á–∞–ª–æ', '–ú–∞—Ç—Ä–∏—Ü–∞']\nprint(movies[1])",
             '‚Ä¢ –ò–Ω–¥–µ–∫—Å—ã: 0,1,2,...\n‚Ä¢ –≠–ª–µ–º–µ–Ω—Ç—ã –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö',
             2, 15),

            (9, "–§—É–Ω–∫—Ü–∏–∏ def", "–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π",
             "–§—É–Ω–∫—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.",
             "def –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é.",
             "def greet():\n    print('–ü—Ä–∏–≤–µ—Ç!')\ngreet()",
             "–°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≤–æ–¥–∏—Ç 'Hello, World!'",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ def –∏ print().",
             "def hello():\n    print('Hello, World!')\nhello()",
             '‚Ä¢ def –∏–º—è_—Ñ—É–Ω–∫—Ü–∏–∏():\n‚Ä¢ –ù–µ –∑–∞–±—É–¥—å—Ç–µ –¥–≤–æ–µ—Ç–æ—á–∏–µ',
             2, 15),

            (10, "–°–ª–æ–≤–∞—Ä–∏", "–°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ",
             "–°–ª–æ–≤–∞—Ä—å —Ö—Ä–∞–Ω–∏—Ç –ø–∞—Ä—ã –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ.",
             "–ö–ª—é—á–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏.",
             "student = {'name': '–ê–Ω–Ω–∞', 'age': 20}\nprint(student['name'])",
             "–°–æ–∑–¥–∞–π—Ç–µ —Å–ª–æ–≤–∞—Ä—å —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≥–æ—Ä–æ–¥–µ (–Ω–∞–∑–≤–∞–Ω–∏–µ, –Ω–∞—Å–µ–ª–µ–Ω–∏–µ).",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏.",
             "city = {'name': '–ú–æ—Å–∫–≤–∞', 'population': 12000000}\nprint(city['name'])",
             '‚Ä¢ {–∫–ª—é—á: –∑–Ω–∞—á–µ–Ω–∏–µ}\n‚Ä¢ –ö–ª—é—á–∏ –≤ –∫–∞–≤—ã—á–∫–∞—Ö',
             2, 15),

            # –£—Ä–æ–∫–∏ 11-15 (—Å—Ä–µ–¥–Ω–∏–µ)
            (11, "–¶–∏–∫–ª while", "–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –¥–æ —É—Å–ª–æ–≤–∏—è",
             "–¶–∏–∫–ª while –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∫–æ–¥, –ø–æ–∫–∞ —É—Å–ª–æ–≤–∏–µ –∏—Å—Ç–∏–Ω–Ω–æ.",
             "–ü–æ–ª–µ–∑–µ–Ω, –∫–æ–≥–¥–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π.",
             "count = 0\nwhile count < 5:\n    print(count)\n    count += 1",
             "–ù–∞–ø–∏—à–∏—Ç–µ —Ü–∏–∫–ª while, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–æ–¥–∏—Ç —á–∏—Å–ª–∞ –æ—Ç 5 –¥–æ 1.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é-—Å—á–µ—Ç—á–∏–∫.",
             "num = 5\nwhile num > 0:\n    print(num)\n    num -= 1",
             '‚Ä¢ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å–ª–æ–≤–∏–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è\n‚Ä¢ –ò–Ω–∞—á–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª',
             3, 20),

            (12, "–ú–µ—Ç–æ–¥—ã —Å—Ç—Ä–æ–∫", "–û–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏",
             "–°—Ç—Ä–æ–∫–∏ –∏–º–µ—é—Ç –ø–æ–ª–µ–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã: upper(), lower(), split().",
             "–ú–µ—Ç–æ–¥—ã –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É.",
             "text = 'Python'\nprint(text.upper())\nprint(text.lower())",
             "–°–¥–µ–ª–∞–π—Ç–µ —Å—Ç—Ä–æ–∫—É 'hello' –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ upper().",
             "text = 'hello'\nprint(text.upper())",
             '‚Ä¢ —Å—Ç—Ä–æ–∫–∞.–º–µ—Ç–æ–¥()\n‚Ä¢ upper() –¥–µ–ª–∞–µ—Ç –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏',
             3, 20),

            (13, "–ú–µ—Ç–æ–¥—ã —Å–ø–∏—Å–∫–æ–≤", "–†–∞–±–æ—Ç–∞ —Å–æ —Å–ø–∏—Å–∫–∞–º–∏",
             "–°–ø–∏—Å–∫–∏ –∏–º–µ—é—Ç –º–µ—Ç–æ–¥—ã: append(), remove(), sort().",
             "append() –¥–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –∫–æ–Ω–µ—Ü.",
             "numbers = [1, 2, 3]\nnumbers.append(4)\nprint(numbers)",
             "–î–æ–±–∞–≤—å—Ç–µ —á–∏—Å–ª–æ 10 –≤ —Å–ø–∏—Å–æ–∫ [1, 2, 3].",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ append().",
             "numbers = [1, 2, 3]\nnumbers.append(10)\nprint(numbers)",
             '‚Ä¢ —Å–ø–∏—Å–æ–∫.append(—ç–ª–µ–º–µ–Ω—Ç)\n‚Ä¢ –ò–∑–º–µ–Ω—è–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫',
             3, 20),

            (14, "–í–æ–∑–≤—Ä–∞—Ç –∑–Ω–∞—á–µ–Ω–∏–π", "–§—É–Ω–∫—Ü–∏–∏ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º",
             "–§—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é return.",
             "return –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ.",
             "def add(a, b):\n    return a + b\nresult = add(5, 3)",
             "–°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–≤–∞–¥—Ä–∞—Ç —á–∏—Å–ª–∞.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ return.",
             "def square(x):\n    return x * x\nprint(square(4))",
             '‚Ä¢ return –≤—ã—Ä–∞–∂–µ–Ω–∏–µ\n‚Ä¢ –§—É–Ω–∫—Ü–∏—è –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ return',
             3, 20),

            (15, "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π", "–ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π",
             "–§—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.",
             "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã - —ç—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏.",
             "def greet(name):\n    print('–ü—Ä–∏–≤–µ—Ç,', name)\ngreet('–ê–Ω–Ω–∞')",
             "–°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–º—è –∏ –≥–æ–≤–æ—Ä–∏—Ç '–ü—Ä–∏–≤–µ—Ç, [–∏–º—è]'.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ —Ñ—É–Ω–∫—Ü–∏–∏.",
             "def hello(name):\n    print('–ü—Ä–∏–≤–µ—Ç,', name)\nhello('–ò–≤–∞–Ω')",
             '‚Ä¢ def —Ñ—É–Ω–∫—Ü–∏—è(–ø–∞—Ä–∞–º–µ—Ç—Ä):\n‚Ä¢ –ü–∞—Ä–∞–º–µ—Ç—Ä –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏',
             3, 20),

            # –£—Ä–æ–∫–∏ 16-20 (–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ)
            (16, "–ú–Ω–æ–∂–µ—Å—Ç–≤–∞", "–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏",
             "–ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ö—Ä–∞–Ω–∏—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã.",
             "–≠–ª–µ–º–µ–Ω—Ç—ã –Ω–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã –∏ –Ω–µ –º–æ–≥—É—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è.",
             "fruits = {'—è–±–ª–æ–∫–æ', '–±–∞–Ω–∞–Ω', '–∞–ø–µ–ª—å—Å–∏–Ω'}\nprint('—è–±–ª–æ–∫–æ' in fruits)",
             "–°–æ–∑–¥–∞–π—Ç–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑ —á–∏—Å–µ–ª 1, 2, 3, 3, 2, 1 –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.",
             "–ü–æ–≤—Ç–æ—Ä—ã —É–¥–∞–ª—è—é—Ç—Å—è.",
             "numbers = {1, 2, 3, 3, 2, 1}\nprint(numbers)",
             '‚Ä¢ {—ç–ª–µ–º–µ–Ω—Ç1, —ç–ª–µ–º–µ–Ω—Ç2}\n‚Ä¢ –ü–æ—Ä—è–¥–æ–∫ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω',
             4, 25),

            (17, "–§–∞–π–ª—ã", "–†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π",
             "Python –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã.",
             "open() –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª, read() —á–∏—Ç–∞–µ—Ç, write() –ø–∏—à–µ—Ç.",
             "file = open('test.txt', 'w')\nfile.write('–ü—Ä–∏–≤–µ—Ç')\nfile.close()",
             "–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∏ –∑–∞–ø–∏—à–∏—Ç–µ –≤ –Ω–µ–≥–æ 'Hello, File!'.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ open() —Å —Ä–µ–∂–∏–º–æ–º 'w'.",
             "file = open('hello.txt', 'w')\nfile.write('Hello, File!')\nfile.close()",
             '‚Ä¢ open(–∏–º—è, —Ä–µ–∂–∏–º)\n‚Ä¢ –ù–µ –∑–∞–±—É–¥—å—Ç–µ close()',
             4, 25),

            (18, "–ò—Å–∫–ª—é—á–µ–Ω–∏—è try-except", "–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫",
             "try-except –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏.",
             "–ö–æ–¥ –≤ try –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –ø—Ä–∏ –æ—à–∏–±–∫–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ except.",
             "try:\n    num = int('abc')\nexcept:\n    print('–û—à–∏–±–∫–∞!')",
             "–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å '123' –≤ —á–∏—Å–ª–æ.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ try-except.",
             "try:\n    num = int('123')\n    print(num)\nexcept:\n    print('–û—à–∏–±–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è')",
             '‚Ä¢ try: –∫–æ–¥\n‚Ä¢ except: –ø—Ä–∏ –æ—à–∏–±–∫–µ\n‚Ä¢ –ú–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏',
             4, 25),

            (19, "–ö–ª–∞—Å—Å—ã", "–û–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ",
             "–ö–ª–∞—Å—Å - —ç—Ç–æ —à–∞–±–ª–æ–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤.",
             "__init__ - –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞.",
             "class Person:\n    def __init__(self, name):\n        self.name = name",
             "–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å Dog —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º name.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ class –∏ __init__.",
             "class Dog:\n    def __init__(self, name):\n        self.name = name\ndog = Dog('–ë–æ–±–∏–∫')",
             '‚Ä¢ class –ò–º—è–ö–ª–∞—Å—Å–∞:\n‚Ä¢ self - —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä\n‚Ä¢ __init__ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç',
             4, 25),

            (20, "–ú–æ–¥—É–ª–∏", "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫",
             "–ú–æ–¥—É–ª–∏ - —ç—Ç–æ —Ñ–∞–π–ª—ã —Å –∫–æ–¥–æ–º Python.",
             "import –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–¥ –∏–∑ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤.",
             "import math\nprint(math.sqrt(16))",
             "–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –º–æ–¥—É–ª—å random –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ random.randint().",
             "import random\nprint(random.randint(1, 10))",
             '‚Ä¢ import –º–æ–¥—É–ª—å\n‚Ä¢ –º–æ–¥—É–ª—å.—Ñ—É–Ω–∫—Ü–∏—è()',
             4, 25),

            # –£—Ä–æ–∫–∏ 21-25 (—ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ)
            (21, "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Å–ø–∏—Å–∫–æ–≤", "–°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤",
             "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Å–ø–∏—Å–∫–æ–≤ - –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è —Å–ø–∏—Å–∫–æ–≤.",
             "[–≤—ã—Ä–∞–∂–µ–Ω–∏–µ for —ç–ª–µ–º–µ–Ω—Ç in –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å].",
             "squares = [x*x for x in range(5)]\nprint(squares)",
             "–°–æ–∑–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ —á–∏—Å–µ–ª –æ—Ç 1 –¥–æ 5.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ø–∏—Å–∫–∞.",
             "squares = [x*x for x in range(1, 6)]\nprint(squares)",
             '‚Ä¢ [–≤—ã—Ä–∞–∂–µ–Ω–∏–µ for ...]\n‚Ä¢ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —É—Å–ª–æ–≤–∏–µ if',
             5, 30),

            (22, "–õ—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏–∏", "–ê–Ω–æ–Ω–∏–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏",
             "–õ—è–º–±–¥–∞ - –º–∞–ª–µ–Ω—å–∫–∞—è –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è.",
             "lambda –∞—Ä–≥—É–º–µ–Ω—Ç—ã: –≤—ã—Ä–∞–∂–µ–Ω–∏–µ",
             "add = lambda x, y: x + y\nprint(add(5, 3))",
             "–°–æ–∑–¥–∞–π—Ç–µ –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —É–º–Ω–æ–∂–∞–µ—Ç —á–∏—Å–ª–æ –Ω–∞ 2.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ lambda.",
             "double = lambda x: x * 2\nprint(double(7))",
             '‚Ä¢ lambda –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: –≤—ã—Ä–∞–∂–µ–Ω–∏–µ\n‚Ä¢ –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ä–∞–∑—É',
             5, 30),

            (23, "–î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã", "–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π",
             "–î–µ–∫–æ—Ä–∞—Ç–æ—Ä - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–µ–Ω—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥—Ä—É–≥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.",
             "@–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –Ω–∞–¥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏.",
             "def decorator(func):\n    def wrapper():\n        print('–î–æ')\n        func()\n        print('–ü–æ—Å–ª–µ')\n    return wrapper",
             "–°–æ–∑–¥–∞–π—Ç–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–æ–¥–∏—Ç '–§—É–Ω–∫—Ü–∏—è –≤—ã–∑–≤–∞–Ω–∞' –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏.",
             "–°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é-–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä.",
             "def my_decorator(func):\n    def wrapper():\n        print('–§—É–Ω–∫—Ü–∏—è –≤—ã–∑–≤–∞–Ω–∞')\n        func()\n    return wrapper\n@my_decorator\ndef hello():\n    print('Hello!')\nhello()",
             '‚Ä¢ def –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä(—Ñ—É–Ω–∫—Ü–∏—è):\n‚Ä¢ @–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –Ω–∞–¥ —Ñ—É–Ω–∫—Ü–∏–µ–π',
             5, 30),

            (24, "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã", "–õ–µ–Ω–∏–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è",
             "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –æ–¥–Ω–æ–º—É.",
             "–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è yield –≤–º–µ—Å—Ç–æ return.",
             "def countdown(n):\n    while n > 0:\n        yield n\n        n -= 1",
             "–°–æ–∑–¥–∞–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–∞ –æ—Ç 0 –¥–æ 4.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ yield.",
             "def my_generator():\n    for i in range(5):\n        yield i\nfor num in my_generator():\n    print(num)",
             '‚Ä¢ def —Ñ—É–Ω–∫—Ü–∏—è():\n‚Ä¢ yield –∑–Ω–∞—á–µ–Ω–∏–µ\n‚Ä¢ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ü–∏–∫–ª–µ for',
             5, 30),

            (25, "–ú–µ–Ω–µ–¥–∂–µ—Ä—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞", "–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ä–µ—Å—É—Ä—Å–∞–º–∏",
             "with –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã.",
             "–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ñ–∞–π–ª–æ–≤, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.",
             "with open('file.txt', 'r') as file:\n    content = file.read()",
             "–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª 'data.txt' –¥–ª—è —á—Ç–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ with open().",
             "with open('data.txt', 'r') as file:\n    data = file.read()\nprint(data)",
             '‚Ä¢ with –æ—Ç–∫—Ä—ã—Ç–∏–µ_—Ä–µ—Å—É—Ä—Å–∞ as –∏–º—è:\n‚Ä¢ –†–µ—Å—É—Ä—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä–æ–µ—Ç—Å—è',
             5, 30),

            # –£—Ä–æ–∫–∏ 26-30 (–ø—Ä–æ–µ–∫—Ç–Ω—ã–µ)
            (26, "–ú–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç: –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä", "–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞",
             "–°–æ–∑–¥–∞–¥–∏–º –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å –±–∞–∑–æ–≤—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏.",
             "–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏.",
             "def add(a, b):\n    return a + b\ndef subtract(a, b):\n    return a - b",
             "–°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é multiply –¥–ª—è —É–º–Ω–æ–∂–µ–Ω–∏—è –¥–≤—É—Ö —á–∏—Å–µ–ª.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä *.",
             "def multiply(a, b):\n    return a * b\nprint(multiply(5, 3))",
             '‚Ä¢ a * b —É–º–Ω–æ–∂–∞–µ—Ç\n‚Ä¢ return –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç',
             5, 35),

            (27, "–ú–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç: –ò–≥—Ä–∞ '–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ'", "–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∏–≥—Ä–∞",
             "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≥–∞–¥—ã–≤–∞–µ—Ç —á–∏—Å–ª–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≥–∞–¥—ã–≤–∞–µ—Ç.",
             "–ò—Å–ø–æ–ª—å–∑—É–µ–º random –∏ —Ü–∏–∫–ª while.",
             "import random\nnumber = random.randint(1, 10)\nguess = int(input('–£–≥–∞–¥–∞–π—Ç–µ —á–∏—Å–ª–æ: '))",
             "–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É, —É–≥–∞–¥–∞–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–∏—Å–ª–æ.",
             "–°—Ä–∞–≤–Ω–∏—Ç–µ guess —Å number.",
             "import random\nnumber = random.randint(1, 10)\nguess = int(input('–£–≥–∞–¥–∞–π—Ç–µ —á–∏—Å–ª–æ: '))\nif guess == number:\n    print('–ü—Ä–∞–≤–∏–ª—å–Ω–æ!')\nelse:\n    print('–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!')",
             '‚Ä¢ == –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è\n‚Ä¢ int() –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–≤–æ–¥ –≤ —á–∏—Å–ª–æ',
             5, 35),

            (28, "–ú–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç: –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á", "–ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–¥–∞—á",
             "–°–æ–∑–¥–∞–¥–∏–º –ø—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á (to-do list).",
             "–ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–ø–∏—Å–æ–∫ –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.",
             "tasks = []\ndef add_task(task):\n    tasks.append(task)",
             "–°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é remove_task –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ remove().",
             "def remove_task(task):\n    tasks.remove(task)\ntasks = ['–£—á–∏—Ç—å—Å—è', '–°–ø–∞—Ç—å']\nremove_task('–°–ø–∞—Ç—å')\nprint(tasks)",
             '‚Ä¢ —Å–ø–∏—Å–æ–∫.remove(—ç–ª–µ–º–µ–Ω—Ç)\n‚Ä¢ –≠–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ',
             5, 35),

            (29, "–ú–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç: –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –≤–∞–ª—é—Ç", "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä",
             "–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ä—É–±–ª–∏ –≤ –¥–æ–ª–ª–∞—Ä—ã –ø–æ –∫—É—Ä—Å—É.",
             "–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –∫—É—Ä—Å–∞.",
             "def convert(rubles, rate):\n    return rubles / rate",
             "–ù–∞–ø–∏—à–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ä—É–±–ª–µ–π –≤ –µ–≤—Ä–æ (–∫—É—Ä—Å 95).",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–ª–µ–Ω–∏–µ.",
             "def rub_to_eur(rubles):\n    return rubles / 95\nprint(rub_to_eur(950))",
             '‚Ä¢ —Ä—É–±–ª–∏ / –∫—É—Ä—Å = –µ–≤—Ä–æ\n‚Ä¢ return –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç',
             5, 35),

            (30, "–ú–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç: –®–∏—Ñ—Ä–∞—Ç–æ—Ä", "–ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ",
             "–®–∏—Ñ—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å–¥–≤–∏–≥–æ–º –±—É–∫–≤ (—à–∏—Ñ—Ä –¶–µ–∑–∞—Ä—è).",
             "–ò—Å–ø–æ–ª—å–∑—É–µ–º ord() –∏ chr() –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–∏–º–≤–æ–ª–∞–º–∏.",
             "def encrypt(text, shift):\n    result = ''\n    for char in text:\n        result += chr(ord(char) + shift)\n    return result",
             "–°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ (–æ–±—Ä–∞—Ç–Ω—ã–π —Å–¥–≤–∏–≥).",
             "–í—ã—á–∏—Ç–∞–π—Ç–µ shift –≤–º–µ—Å—Ç–æ —Å–ª–æ–∂–µ–Ω–∏—è.",
             "def decrypt(text, shift):\n    result = ''\n    for char in text:\n        result += chr(ord(char) - shift)\n    return result\nprint(decrypt('ifmmp', 1))",
             '‚Ä¢ ord() - –∫–æ–¥ —Å–∏–º–≤–æ–ª–∞\n‚Ä¢ chr() - —Å–∏–º–≤–æ–ª –∏–∑ –∫–æ–¥–∞\n‚Ä¢ -shift –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏',
             5, 35),

            # –£—Ä–æ–∫–∏ 31-35 (–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø—Ä–æ–µ–∫—Ç—ã)
            (31, "API –∑–∞–ø—Ä–æ—Å—ã", "–†–∞–±–æ—Ç–∞ —Å –≤–Ω–µ—à–Ω–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏",
             "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ requests –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.",
             "requests.get() –¥–µ–ª–∞–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å.",
             "import requests\nresponse = requests.get('https://api.github.com')\nprint(response.status_code)",
             "–°–¥–µ–ª–∞–π—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ JSONPlaceholder API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å—Ç–∞.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ requests.get().",
             "import requests\nresponse = requests.get('https://jsonplaceholder.typicode.com/posts/1')\nprint(response.json()['title'])",
             '‚Ä¢ requests.get(url)\n‚Ä¢ response.json() –¥–ª—è JSON\n‚Ä¢ –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ requests',
             5, 40),

            (32, "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLite", "–†–∞–±–æ—Ç–∞ —Å –ë–î",
             "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ sqlite3 –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.",
             "connect() —Å–æ–∑–¥–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, cursor() –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã.",
             "import sqlite3\nconn = sqlite3.connect('test.db')\ncursor = conn.cursor()\ncursor.execute('CREATE TABLE users (id INTEGER, name TEXT)')",
             "–°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É products —Å –ø–æ–ª—è–º–∏ id –∏ name.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CREATE TABLE.",
             "import sqlite3\nconn = sqlite3.connect('shop.db')\ncursor = conn.cursor()\ncursor.execute('CREATE TABLE products (id INTEGER, name TEXT)')\nconn.close()",
             '‚Ä¢ CREATE TABLE –∏–º—è (–ø–æ–ª—è)\n‚Ä¢ –ù–µ –∑–∞–±—É–¥—å—Ç–µ conn.close()',
             5, 40),

            (33, "Web scraping", "–ü–∞—Ä—Å–∏–Ω–≥ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü",
             "–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü —Å –ø–æ–º–æ—â—å—é BeautifulSoup.",
             "bs4 –ø–∞—Ä—Å–∏—Ç HTML –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–∫–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã.",
             "from bs4 import BeautifulSoup\nhtml = '<html><body><h1>–ó–∞–≥–æ–ª–æ–≤–æ–∫</h1></body></html>'\nsoup = BeautifulSoup(html, 'html.parser')\nprint(soup.h1.text)",
             "–ù–∞–π–¥–∏—Ç–µ –≤—Å–µ —Å—Å—ã–ª–∫–∏ <a> –≤ HTML-–¥–æ–∫—É–º–µ–Ω—Ç–µ.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ find_all().",
             "from bs4 import BeautifulSoup\nhtml = '<html><a href=\"#\">–°—Å—ã–ª–∫–∞1</a><a href=\"#\">–°—Å—ã–ª–∫–∞2</a></html>'\nsoup = BeautifulSoup(html, 'html.parser')\nlinks = soup.find_all('a')\nfor link in links:\n    print(link.text)",
             '‚Ä¢ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ beautifulsoup4\n‚Ä¢ find_all(\'tag\') –∏—â–µ—Ç –≤—Å–µ —Ç–µ–≥–∏',
             5, 40),

            (34, "–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ", "async/await",
             "–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.",
             "async def –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, await –∂–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.",
             "import asyncio\nasync def hello():\n    print('Hello')\n    await asyncio.sleep(1)\n    print('World')\nasyncio.run(hello())",
             "–°–æ–∑–¥–∞–π—Ç–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—á–∞—Ç–∞–µ—Ç 'Start', –∂–¥–µ—Ç 2 —Å–µ–∫—É–Ω–¥—ã, –∑–∞—Ç–µ–º 'End'.",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ asyncio.sleep().",
             "import asyncio\nasync def my_task():\n    print('Start')\n    await asyncio.sleep(2)\n    print('End')\nasyncio.run(my_task())",
             '‚Ä¢ async def —Ñ—É–Ω–∫—Ü–∏—è()\n‚Ä¢ await asyncio.sleep(—Å–µ–∫—É–Ω–¥—ã)\n‚Ä¢ asyncio.run() –∑–∞–ø—É—Å–∫–∞–µ—Ç',
             5, 40),

            (35, "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ", "Unit tests —Å pytest",
             "–ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–¥–∞.",
             "pytest –Ω–∞—Ö–æ–¥–∏—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.",
             "def add(a, b):\n    return a + b\ndef test_add():\n    assert add(2, 3) == 5",
             "–ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ multiply (–∏–∑ —É—Ä–æ–∫–∞ 26).",
             "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ assert.",
             "def multiply(a, b):\n    return a * b\ndef test_multiply():\n    assert multiply(4, 5) == 20\nprint('–¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω!')",
             '‚Ä¢ def test_–∏–º—è():\n‚Ä¢ assert —É—Å–ª–æ–≤–∏–µ\n‚Ä¢ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ pytest –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è',
             5, 40),
        ]

        for (order_num, title, description, content, detailed_explanation,
             code_example, exercise, exercise_explanation, solution, hints,
             difficulty, xp_reward) in lessons:
            c.execute('''INSERT INTO lessons 
                (title, description, content, detailed_explanation, 
                 code_example, exercise, exercise_explanation, 
                 solution, hints, difficulty, order_num, xp_reward)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)''',
                      (title, description, content, detailed_explanation,
                       code_example, exercise, exercise_explanation,
                       solution, hints, difficulty, order_num, xp_reward))

    conn.commit()
    conn.close()


def get_db():
    conn = sqlite3.connect('python_game.db', check_same_thread=False)
    conn.row_factory = sqlite3.Row
    return conn


def validate_username(username):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    if len(username) < 3:
        return False, "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞"

    if len(username) > 20:
        return False, "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ 20 —Å–∏–º–≤–æ–ª–æ–≤"

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –±—É–∫–≤—É
    if not re.search(r'[a-zA-Z–∞-—è–ê-–Ø]', username):
        return False, "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –±—É–∫–≤—É"

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã
    if not re.match(r'^[a-zA-Z–∞-—è–ê-–Ø0-9_]+$', username):
        return False, "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –Ω–∏–∂–Ω–µ–µ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ"

    return True, ""


def validate_password(password):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è"""
    if len(password) < 6:
        return False, "–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤"

    if len(password) > 50:
        return False, "–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ 50 —Å–∏–º–≤–æ–ª–æ–≤"

    return True, ""


@app.route('/')
def index():
    if 'user_id' in session:
        return redirect('/dashboard')
    return render_template('index.html')


@app.route('/register', methods=['GET', 'POST'])
def register():
    if request.method == 'POST':
        username = request.form['username'].strip()
        password = request.form['password']

        # –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        is_valid_username, username_error = validate_username(username)
        if not is_valid_username:
            return render_template('register.html', error=username_error, username=username)

        # –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è
        is_valid_password, password_error = validate_password(password)
        if not is_valid_password:
            return render_template('register.html', error=password_error, username=username)

        conn = get_db()
        try:
            c = conn.cursor()
            c.execute("INSERT INTO users (username, password) VALUES (?, ?)", (username, password))
            conn.commit()
            user_id = c.lastrowid

            session['user_id'] = user_id
            session['username'] = username
            session['experience'] = 0
            session['level'] = 1
            session['daily_streak'] = 0

            return redirect('/dashboard')
        except sqlite3.IntegrityError:
            return render_template('register.html', error="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ –∑–∞–Ω—è—Ç–æ", username=username)
        except Exception as e:
            return render_template('register.html', error="–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏", username=username)
        finally:
            conn.close()

    return render_template('register.html')


@app.route('/login', methods=['GET', 'POST'])
def login():
    if request.method == 'POST':
        username = request.form['username'].strip()
        password = request.form['password']

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if not username:
            return render_template('login.html', error="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")

        if not re.search(r'[a-zA-Z–∞-—è–ê-–Ø]', username):
            return render_template('login.html', error="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –±—É–∫–≤—ã")

        conn = get_db()
        user = conn.execute("SELECT * FROM users WHERE username = ? AND password = ?", (username, password)).fetchone()
        conn.close()

        if user:
            session['user_id'] = user['id']
            session['username'] = user['username']
            session['experience'] = user['experience']
            session['level'] = user['level']
            session['daily_streak'] = user['daily_streak']
            return redirect('/dashboard')
        else:
            return render_template('login.html', error="–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å")

    return render_template('login.html')


@app.route('/dashboard')
def dashboard():
    if 'user_id' not in session:
        return redirect('/login')

    conn = get_db()
    user = conn.execute("SELECT * FROM users WHERE id = ?", (session['user_id'],)).fetchone()

    # –ü–æ–ª—É—á–∞–µ–º —É—Ä–æ–∫–∏ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
    lessons = conn.execute('''
        SELECT l.*, p.completed, p.score 
        FROM lessons l 
        LEFT JOIN progress p ON l.id = p.lesson_id AND p.user_id = ?
        ORDER BY l.order_num
    ''', (session['user_id'],)).fetchall()

    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Ä–æ–∫–∏ –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
    levels = {}
    for lesson in lessons:
        diff = lesson['difficulty']
        if diff not in levels:
            levels[diff] = []
        levels[diff].append(dict(lesson))

    # –°—á–∏—Ç–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    completed = sum(1 for lesson in lessons if lesson['completed'])
    total = len(lessons)
    progress = int((completed / total * 100)) if total > 0 else 0

    conn.close()

    return render_template('dashboard.html',
                           user=dict(user),
                           lessons=lessons,
                           levels=levels,
                           completed=completed,
                           total=total,
                           progress=progress)


@app.route('/lesson/<int:lesson_id>')
def lesson(lesson_id):
    if 'user_id' not in session:
        return redirect('/login')

    conn = get_db()
    lesson = conn.execute("SELECT * FROM lessons WHERE id = ?", (lesson_id,)).fetchone()

    if not lesson:
        conn.close()
        return "–£—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω"

    conn.close()

    return render_template('lesson.html',
                           lesson=dict(lesson))


@app.route('/practice/<int:lesson_id>')
def practice(lesson_id):
    if 'user_id' not in session:
        return redirect('/login')

    conn = get_db()
    lesson = conn.execute("SELECT * FROM lessons WHERE id = ?", (lesson_id,)).fetchone()
    conn.close()

    if not lesson:
        return "–£—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω"

    return render_template('practice.html', lesson=dict(lesson))


@app.route('/check_code', methods=['POST'])
def check_code():
    if 'user_id' not in session:
        return jsonify({'success': False, 'message': '–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É'})

    data = request.json
    lesson_id = data.get('lesson_id')
    user_code = data.get('code', '')

    conn = get_db()
    lesson = conn.execute("SELECT solution, xp_reward FROM lessons WHERE id = ?", (lesson_id,)).fetchone()

    if not lesson:
        conn.close()
        return jsonify({'success': False, 'message': '–£—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω'})

    # –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
    solution = lesson['solution'].strip().lower()
    user_code_clean = user_code.strip().lower()
    is_correct = solution in user_code_clean

    if is_correct:
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
        conn.execute('''
            INSERT OR REPLACE INTO progress (user_id, lesson_id, completed, score)
            VALUES (?, ?, 1, ?)
        ''', (session['user_id'], lesson_id, lesson['xp_reward']))

        # –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø—ã—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        conn.execute("UPDATE users SET experience = experience + ? WHERE id = ?",
                     (lesson['xp_reward'], session['user_id']))

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
        user = conn.execute("SELECT experience FROM users WHERE id = ?",
                            (session['user_id'],)).fetchone()
        new_level = user['experience'] // 100 + 1
        old_level = session.get('level', 1)

        if new_level > old_level:
            conn.execute("UPDATE users SET level = ? WHERE id = ?", (new_level, session['user_id']))
            session['level'] = new_level
            level_up = True
        else:
            level_up = False

        session['experience'] = user['experience']
        conn.commit()
    else:
        level_up = False

    conn.close()

    if is_correct:
        message = f'‚úÖ –û—Ç–ª–∏—á–Ω–æ! +{lesson["xp_reward"]} XP'
        if level_up:
            message += f' üéâ –ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å: {new_level}!'
        return jsonify({
            'success': True,
            'message': message,
            'level_up': level_up
        })
    else:
        return jsonify({
            'success': False,
            'message': '‚ùå –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!'
        })


@app.route('/achievements')
def achievements():
    if 'user_id' not in session:
        return redirect('/login')

    conn = get_db()
    user = conn.execute("SELECT * FROM users WHERE id = ?", (session['user_id'],)).fetchone()

    # –°—á–∏—Ç–∞–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —É—Ä–æ–∫–∏
    completed = conn.execute("SELECT COUNT(*) FROM progress WHERE user_id = ? AND completed = 1",
                             (session['user_id'],)).fetchone()[0]

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
    achievements = []

    if completed >= 1:
        achievements.append(('üìö', '–ù–∞—á–∞–ª–æ –ø—É—Ç–∏', '–ó–∞–≤–µ—Ä—à–µ–Ω 1 —É—Ä–æ–∫', 'bronze'))
    if completed >= 3:
        achievements.append(('üéì', '–£—á–µ–Ω–∏–∫', '–ó–∞–≤–µ—Ä—à–µ–Ω–æ 3 —É—Ä–æ–∫–∞', 'silver'))
    if completed >= 5:
        achievements.append(('‚≠ê', '–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫', '–ó–∞–≤–µ—Ä—à–µ–Ω–æ 5 —É—Ä–æ–∫–æ–≤', 'gold'))
    if completed >= 10:
        achievements.append(('üöÄ', '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π', '–ó–∞–≤–µ—Ä—à–µ–Ω–æ 10 —É—Ä–æ–∫–æ–≤', 'gold'))
    if completed >= 20:
        achievements.append(('üèÜ', '–≠–∫—Å–ø–µ—Ä—Ç', '–ó–∞–≤–µ—Ä—à–µ–Ω–æ 20 —É—Ä–æ–∫–æ–≤', 'gold'))
    if completed >= 30:
        achievements.append(('üëë', '–ú–∞—Å—Ç–µ—Ä', '–ó–∞–≤–µ—Ä—à–µ–Ω–æ 30 —É—Ä–æ–∫–æ–≤', 'gold'))

    if user['experience'] >= 30:
        achievements.append(('‚ö°', '–û–ø—ã—Ç–Ω—ã–π', '–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ 30 XP', 'bronze'))
    if user['experience'] >= 50:
        achievements.append(('üíé', '–í–µ—Ç–µ—Ä–∞–Ω', '–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ 50 XP', 'silver'))
    if user['experience'] >= 100:
        achievements.append(('üî•', '–õ–µ–≥–µ–Ω–¥–∞', '–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ 100 XP', 'gold'))
    if user['experience'] >= 500:
        achievements.append(('üåü', '–°—É–ø–µ—Ä–∑–≤–µ–∑–¥–∞', '–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ 500 XP', 'gold'))

    if user['level'] >= 2:
        achievements.append(('ü•â', '–ë—Ä–æ–Ω–∑–∞', '–î–æ—Å—Ç–∏–≥–Ω—É—Ç —É—Ä–æ–≤–µ–Ω—å 2', 'bronze'))
    if user['level'] >= 3:
        achievements.append(('ü•à', '–°–µ—Ä–µ–±—Ä–æ', '–î–æ—Å—Ç–∏–≥–Ω—É—Ç —É—Ä–æ–≤–µ–Ω—å 3', 'silver'))
    if user['level'] >= 5:
        achievements.append(('ü•á', '–ó–æ–ª–æ—Ç–æ', '–î–æ—Å—Ç–∏–≥–Ω—É—Ç —É—Ä–æ–≤–µ–Ω—å 5', 'gold'))
    if user['level'] >= 10:
        achievements.append(('üëë', '–ö–æ—Ä–æ–ª—å Python', '–î–æ—Å—Ç–∏–≥–Ω—É—Ç —É—Ä–æ–≤–µ–Ω—å 10', 'gold'))

    conn.close()

    return render_template('achievements.html',
                           user=dict(user),
                           achievements=achievements,
                           completed=completed)


@app.route('/logout')
def logout():
    session.clear()
    return redirect('/')


if __name__ == '__main__':
    if not os.path.exists('templates'):
        os.makedirs('templates')

    init_db()
    print("=" * 60)
    print("üéÆ PYTHON MASTER - –†–ê–°–®–ò–†–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø")
    print(f"üìö –í—Å–µ–≥–æ —É—Ä–æ–∫–æ–≤: 35 (–æ—Ç –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–æ —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã—Ö)")
    print("üîí –ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤ –≤ –ø–∞—Ä–æ–ª–µ")
    print("üî§ –ë—É–∫–≤—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –≤ –ª–æ–≥–∏–Ω–µ")
    print("üìä –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —É—Ä–æ–∫–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏")
    print("üéØ 5 —É—Ä–æ–≤–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: –æ—Ç 1 (–Ω–∞—á–∞–ª—å–Ω—ã–π) –¥–æ 5 (—ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π)")
    print("üëâ http://localhost:5000")
    print("=" * 60)
    app.run(debug=True, port=5000)